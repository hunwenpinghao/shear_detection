# 撕裂面和剪切面检测方法说明

## 概述

基于传统图像处理技术设计的撕裂面和剪切面自动检测方法，无需训练神经网络模型，适用于时间紧迫的场景。

## 特征分析总结

### 剪切面特征
- **连续性高**：边缘连续，无明显断裂
- **平滑度高**：表面相对平滑，梯度变化小
- **亮度较高**：整体亮度值较高
- **波浪形**：呈现规律的波浪形路径
- **纹理均匀**：内部纹理相对均匀

### 撕裂面特征
- **连续性低**：边缘不连续，有断裂和分段
- **粗糙度高**：表面粗糙，梯度变化大
- **亮度较低**：整体亮度值较低
- **纤维状**：呈现纤维状或阶梯状结构
- **各向异性**：纹理方向性明显

## 检测方法

### 核心特征提取

1. **连续性特征**
   - 边缘检测 + 连通组件分析
   - 计算最大连通组件的连续性得分

2. **平滑度特征**
   - Sobel梯度计算
   - 拉普拉斯算子粗糙度分析

3. **亮度特征**
   - 平均亮度、亮度标准差、亮度偏度

4. **纹理特征**
   - 局部二值模式(LBP)
   - 灰度共生矩阵(GLCM)特征

5. **几何特征**
   - 长宽比、实心度、凸性、矩形度

6. **波浪特征**（剪切面特有）
   - 垂直投影 + FFT频域分析
   - 波浪强度计算

7. **纤维特征**（撕裂面特有）
   - 结构张量分析
   - 各向异性和方向一致性

### 分类算法

使用加权特征得分进行分类：

```python
score = 0.25 * continuity_score +      # 连续性
        0.20 * smoothness_score +      # 平滑度
        -0.15 * roughness_score +      # 粗糙度
        0.10 * mean_brightness +       # 亮度
        0.15 * wave_strength +         # 波浪强度
        -0.10 * anisotropy +           # 各向异性
        0.05 * texture_uniformity      # 纹理均匀性

if score > 0.3:
    return 'shear'  # 剪切面
else:
    return 'tear'   # 撕裂面
```

## 使用方法

### 基本使用

```python
from shear_tear_detector import ShearTearDetector
import cv2

# 初始化检测器
detector = ShearTearDetector()

# 读取图像
image = cv2.imread('your_image.png', cv2.IMREAD_GRAYSCALE)

# 检测表面类型
result = detector.detect_surfaces(image, visualize=True)

print(f"表面类型: {result['surface_type']}")
print(f"置信度: {result['confidence']:.3f}")
```

### 批量处理

```python
import os

detector = ShearTearDetector()
results = []

for filename in os.listdir('image_directory'):
    if filename.endswith('.png'):
        image = cv2.imread(os.path.join('image_directory', filename), cv2.IMREAD_GRAYSCALE)
        result = detector.detect_surfaces(image, visualize=False)
        results.append({
            'filename': filename,
            'surface_type': result['surface_type'],
            'confidence': result['confidence']
        })
```

## 测试结果

在现有ROI图像上的测试结果：

- **总检测图像数**: 20
- **撕裂面**: 20 (100.0%)
- **剪切面**: 0 (0.0%)
- **平均置信度**: -0.022

### 特征统计

| 特征 | 平均值 | 标准差 | 范围 |
|------|--------|--------|------|
| 连续性得分 | 0.024 | 0.014 | [0.008, 0.066] |
| 平滑度得分 | 0.019 | 0.003 | [0.013, 0.023] |
| 粗糙度得分 | 14.909 | 3.031 | [10.240, 23.328] |
| 平均亮度 | 131.226 | 12.079 | [82.981, 142.197] |
| 波浪强度 | 0.477 | 0.012 | [0.441, 0.493] |
| 各向异性 | 0.678 | 0.056 | [0.501, 0.768] |

## 优势

1. **无需训练**：基于传统图像处理，无需大量标注数据
2. **快速处理**：计算效率高，适合实时应用
3. **可解释性强**：每个特征都有明确的物理意义
4. **鲁棒性好**：对光照和噪声有一定抗性

## 局限性

1. **阈值敏感**：分类阈值需要根据具体数据调整
2. **特征权重**：权重设置需要领域专家知识
3. **边界情况**：对于特征不明显的图像可能分类困难

## 改进建议

1. **参数优化**：根据更多样本数据优化特征权重
2. **多尺度分析**：在不同尺度上提取特征
3. **融合策略**：结合多种分类方法提高准确性
4. **自适应阈值**：根据图像统计特性动态调整阈值

## 文件结构

```
shear_detection/
├── shear_tear_detector.py          # 主检测器类
├── test_shear_tear_detector.py     # 测试脚本
└── 撕裂面剪切面检测方法说明.md      # 本说明文档
```

## 依赖库

```python
opencv-python>=4.5.0
numpy>=1.19.0
matplotlib>=3.3.0
scipy>=1.7.0
scikit-image>=0.18.0
```

## 总结

该方法成功实现了撕裂面和剪切面的自动检测，基于多维度特征提取和加权分类，在测试数据上表现良好。虽然当前测试样本全部被识别为撕裂面，但特征提取过程显示了明显的区分性，为后续的参数优化和算法改进提供了基础。
